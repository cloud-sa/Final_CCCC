<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

<!-- 	<select id="login" resultMap="memberResultSet">
		select * 
		from MEMBER
		where member_id=#{id} and member_pwd=#{pwd} and status='Y'
		where user_id=#{user_id} and user_pass=#{user_password} and status='Y'
	</select>
	<resultMap type="Member" id="memberResultSet">
		<id column="user_NO" property="user_no"/>
		<result column="USER_ID" property="user_id"/>
		<result column="USER_PASS" property="user_password"/>
		<result column="NICKNAME" property="nickname"/>
		<result column="EMAIL" property="email"/>
		<result column="GENDER" property="gender"/>
		<result column="AGR" property="age"/>
		<result column="AUTHORITY" property="authority"/>
		<result column="STATUS" property="status"/>
		<result column="SURVEY_YN" property="survey_yn"/>
		<result column="USER_NAME" property="user_name"/>
		<result column="U_CRE_DATE" property="u_cre_date"/>
		<result column="U_MOD_DATE" property="u_mod_date"/>
		<result column="U_DEL_DATE" property="u_del_date"/>
		<result column="PASS_CNT" property="pass_cnt"/>
			
	</resultMap> -->
	
	
	
		<select id="loginCheck" resultMap="memberResultSet">
		select * 
		from MEMBER
<!-- 		where member_id=#{id} and member_pwd=#{pwd} and status='Y' -->
		where user_id=#{user_id} and user_pass=#{user_password} and status='Y'
	</select>
	<resultMap type="Member" id="memberResultSet">
		<id column="user_NO" property="user_no"/>
		<result column="USER_ID" property="user_id"/>
		<result column="USER_PASS" property="user_password"/>
		<result column="NICKNAME" property="nickname"/>
		<result column="EMAIL" property="email"/>
		<result column="GENDER" property="gender"/>
		<result column="AGR" property="age"/>
		<result column="AUTHORITY" property="authority"/>
		<result column="STATUS" property="status"/>
		<result column="SURVEY_YN" property="survey_yn"/>
		<result column="USER_NAME" property="user_name"/>
		<result column="U_CRE_DATE" property="u_cre_date"/>
		<result column="U_MOD_DATE" property="u_mod_date"/>
		<result column="U_DEL_DATE" property="u_del_date"/>
		<result column="PASS_CNT" property="pass_cnt"/>
			
	</resultMap>
	
	
	<!-- 아이디 중복체크 관련 쿼리 -->
	<select id="idCheck" resultType="int" parameterType="String">
		
		SELECT COUNT(*)
		FROM MEMBER
		WHERE USER_ID = #{user_id}
	
	
	</select>
	
	
	<!-- 닉네임 중복 체크 관련 쿼리 -->
	<select id="nickNameCheck" resultType="int" parameterType="String">
		
		SELECT COUNT(*)
		FROM MEMBER
		WHERE NICKNAME = #{nickName}
	
	
	</select>
	
	
	<!-- 닉네임 중복체크 관련 쿼리 -->
	<select id="emailCheck" resultType="int" parameterType="String">
		
		SELECT COUNT(*)
		FROM MEMBER
		WHERE EMAIL = #{email}
	
	
	</select>
	
	<!-- 회원가입 쿼리  -->
	
	<insert id="insertMember">
	INSERT INTO MEMBER VALUES (SEQ_USER_NO.NEXTVAL,#{user_id},#{user_password},#{nickname},#{email},#{gender},#{age},DEFAULT,DEFAULT,DEFAULT,#{user_name},SYSDATE,DEFAULT,DEFAULT,#{pass_cnt})

	</insert>
	
	
	<!-- 회원탈퇴 아이디 / 비밀번호 체크  -->
	<update id="deleteMemberCheck"  parameterType="Member">
		
		UPDATE MEMBER
		SET STATUS = 'N',PASS_CNT= 0
		WHERE USER_ID = #{user_id} AND USER_PASS = #{user_password}

	
	
	</update>
	
	<!-- 회원탈퇴 키운트 누적 쿼리  -->
	<update id="count_pass_cnt"  parameterType="Member">
		
		UPDATE MEMBER
		SET PASS_CNT = PASS_CNT+1
		WHERE USER_ID = #{user_id} 

	</update>
	
	
	<!--pass_cnt 초기화 쿠리  -->
	<update id="reset_pass_cnt"  parameterType="String">
		
		UPDATE MEMBER
		SET PASS_CNT = 0
		WHERE USER_ID = #{user_id} 

	</update>

	<!-- 회원탈퇴 카운트 검사 쿼리-->
	<select id="count_DeleteMemberCheck_Num" resultType="int" parameterType="Member">
			
		SELECT COUNT(*)
		FROM MEMBER
		WHERE USER_ID = #{user_id} AND PASS_CNT >=5
	
	
	</select>
	
	

	
	
	
	
	
	
	

	
	
	
	


</mapper>
